<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.alibaba.alimei.dao.IDeviceTokenMapper">
	<select id="getDeviceToken" resultType="DeviceTokenInfo"
		useCache="true">
	    <![CDATA[
	   select * from devicetoken where appname=#{appName} and userid=#{userId} and deviceid=#{deviceId} and deviceTokenInfo=#{deviceTokenInfo}
	    ]]>
	</select>

    <select id="getDeviceTokenList" resultType="DeviceTokenInfo"
            useCache="true">
	    <![CDATA[
	   select * from devicetoken where appname=#{appName} and userid=#{userId}
	    ]]>
	</select>

	<insert id="insertDeviceToken" parameterType="DeviceTokenInfo"
		useGeneratedKeys="false">
	         <![CDATA[
	   insert into devicetoken(id,appname,deviceTokenInfo,userId,mailuid,deviceid,os,gmt_create,gmt_modified) values (#{id},#{appName},#{deviceTokenInfo},#{userId},#{mailuid},#{deviceid},#{os},#{gmt_create},#{gmt_modified})
	    ]]>
	</insert>
	
	<update id="updateDeviceToken" parameterType="DeviceTokenInfo">
	         <![CDATA[
	   update devicetoken set deviceTokenInfo=#{deviceTokenInfo},gmt_modified=#{gmt_modified} where id=#{id} and userId=#{userId}
	    ]]>
	</update>
	
	<delete id="removeDeviceToken" parameterType="DeviceTokenInfo">
	<![CDATA[
	   delete from devicetoken where appname=#{appName} and userId=#{userId} and deviceid=#{deviceid}
	    ]]>
	</delete>
	
	<delete id="removeDeviceTokenByUserIdAndDeviceIdNull" parameterType="DeviceTokenInfo">
		<![CDATA[
	   delete from devicetoken where appname=#{appName} and userId=#{userId} and deviceid is null
	    ]]>
	</delete>
	
</mapper>